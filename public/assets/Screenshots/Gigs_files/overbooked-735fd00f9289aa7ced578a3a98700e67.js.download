!function(e){function i(e){this.id=e,this.selectors={},this.models={},this.init()}i.prototype={init:function(){var i=this,o=i.selectors,t=i.models;t.gig_id=i.id,o.$gig=e('tr.mygigs-statistics[data-id="'+i.id+'"]'),o.$gig.hasClass("overbooked-binded")||(o.$gig.addClass("overbooked-binded"),o.$toggleOverbooked=o.$gig.find(".js-btn-toggle-overbooked"),o.$toggleOverbookedDirect=o.$gig.find(".js-btn-toggle-overbooked-direct"),o.$chkOverbooked=o.$toggleOverbooked.find('input[type="checkbox"]'),o.$chkOverbookedDirect=o.$toggleOverbookedDirect.find('input[type="checkbox"]'),o.$limitOverbooked=o.$gig.find("input.js-limit-order-queue"),o.$limitOrdersNumberError=o.$gig.find(".limit-orders-number_error"),o.$limitOrdersSaved=o.$gig.find(".limit-orders-saved"),t.timeoutId=0,i.bindOverbookedButtons())},bindOverbookedButtons:function(){var i=this,o=i.selectors,t=i.models;o.$chkOverbooked.change(function(t){o.$toggleOverbooked.parent().next().toggleClass("limit-applied",e(this).is(":checked")),i.updateGigOverbooked()}),o.$limitOverbooked.keyup(function(d){clearTimeout(t.timeoutId),parseInt(e(this).val())>=0?(e(this).removeClass("with-error"),o.$limitOrdersNumberError.hide(),t.timeoutId=setTimeout(function(){i.updateGigOverbookedWithSaved()},600)):(e(this).addClass("with-error"),o.$limitOrdersNumberError.show())}),o.$chkOverbookedDirect.change(function(e){i.updateGigOverbooked()})},updateGigOverbooked:function(){var i=this,o=i.selectors,t=i.models,d={active:o.$chkOverbooked.is(":checked"),threshold:parseInt(o.$limitOverbooked.val()),allow_direct_buying:o.$chkOverbookedDirect.is(":checked"),gig_id:t.gig_id,source:document.pageScope.main+"."+document.pageScope.sub};e.ajax({type:"patch",dataType:"json",data:d,url:"/traffiq/"+t.gig_id,success:function(e){}})},updateGigOverbookedWithSaved:function(){var e=this,i=e.selectors;e.models;i.$limitOrdersSaved.addClass("shown"),setTimeout(function(){i.$limitOrdersSaved.removeClass("shown")},4e3),e.updateGigOverbooked()}},window.fOverbookedMode=function(e){new i(e)}}(jQuery);