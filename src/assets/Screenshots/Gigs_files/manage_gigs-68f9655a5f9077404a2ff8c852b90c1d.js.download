!function(){var e=document.viewData||{},t={GIG_MENU_CLICK:"Manage Gigs gig menu clicked",GIG_MENU_ITEM_CLICK:"Manage Gigs gig menu item clicked",GIG_CLICK:"Manage Gigs gig clicked",GIG_TOGGLE:"Manage Gigs gig toggle clicked",GIG_PLAN_CLICK:"Manage Gigs Plan Click",GIG_PERFORMANCE_EVENT_TYPE_SELECT:"Manage Gigs gig performance event type changed"};fDashboardNew.manageGigs={models:{c:Fiverr.models.context,b:Fiverr.models.browser,user:Fiverr.models.user,ps:Fiverr.models.ps,page:{currentFilter:e.current_filter,currentFilterTitle:e.current_filter_title,dds:{timeRange:e.dds?e.dds.timeRange:""},popups:{statuses:e.popups?e.popups.statuses:""},results:{rows:e.results?e.results.rows:""}},baseRoute:"/users/"+Fiverr.models.user.userName+"/manage_gigs",educationLocalStorageKey:"fiverr_education_manage_gigs"},selectors:{$container:[],$mainTable:[],$popup:[],$btnStatusesPopup:$(".js-open-statuses-popup"),bulkActions:{$selectAllGigs:$(".js-cbx-all-gigs"),$container:$(".js-bulk-actions-wrap"),$btnMyGigsAction:$(".js-btn-my-gigs-action")},dds:{$timeRange:$(".js-ddown-time-range")}},init:function(){o.$container=$(".js-db-cont"),o.$mainTable=$(".js-db-table"),$(window).on("afterAddTableRows",function(){Fiverr.initfakeDropdown(o.$container),Fiverr.checkForBrokenImg(o.$container),n.attachEvents()}),a.page.results.rows&&i.shared.addTableRows(a.page.results.rows,o.$mainTable.find("tbody")),a.page.loadMoreUrl&&i.shared.bindBasicLoadMore(a.page.loadMoreUrl,o.$mainTable),i.shared.statusTabs.init(n),n.initToggles(),n.initGigTranslationsEducation(),n.bindEvents(),n.initTooltip()},initToggles:function(){this.initCustomOrderToggle(),this.initBriefToggle(),fLoader({load:["//assetsv2.fiverrcdn.com/assets/overbooked-735fd00f9289aa7ced578a3a98700e67.js"],complete:function(){var e=ft.utl.getUrlHashVars().id;e&&_.delay(function(){$gigExpander=$("[data-id="+e+"] .js-toggle-gig-stats a")[0],$gigExpander.click()},500)}})},initCustomOrderToggle:function(){o.$toggleCustomOrder=o.$container.find(".js-btn-toggle-custom-order"),o.$chkCustomOrder=o.$toggleCustomOrder.find('input[type="checkbox"]'),o.$chkCustomOrder.on("change",function(){o.$chkCustomOrder.toggleClass("sel"),$.ajax({url:"/users/"+a.user.userName+"/custom_orders",method:"POST",data:{allow:o.$chkCustomOrder.prop("checked")},error:function(){n.displayFlashError()}})})},initBriefToggle:function(){o.$toggleAcceptBriefs=o.$container.find(".js-btn-toggle-accept-briefs"),o.$btnToggleSetBriefBudget=o.$container.find(".js-btn-toggle-set-brief-budget"),o.$setAcceptingBriefBudgetPopover=o.$container.find(".js-set-accepting-brief-budget-popover"),o.$setAcceptingBriefBudgetForm=o.$setAcceptingBriefBudgetPopover.find(".js-set-accepting-brief-budget-form"),o.$btnBriefBudgetPopoverClose=o.$setAcceptingBriefBudgetPopover.find(".js-btn-close"),o.$btnBriefBudgetPopoverCancel=o.$setAcceptingBriefBudgetPopover.find(".js-btn-cancel"),o.$btnBriefBudgetPopoverSave=o.$setAcceptingBriefBudgetPopover.find(".js-btn-save"),o.$budgetInput=o.$setAcceptingBriefBudgetPopover.find(".js-budget-input"),o.$acceptBriefsCheckbox=o.$toggleAcceptBriefs.find('input[type="checkbox"]'),a.acceptingBriefBudget={minBudget:o.$budgetInput.val(),educationTooltipStorageKey:"fiverr_education_tooltips.accepting_brief_education"},o.$toggleAcceptBriefs.length&&n.initAcceptingBriefsEducation(),o.$acceptBriefsCheckbox.on("change",function(){var e=o.$acceptBriefsCheckbox.prop("checked");n.reportSellerSettingsEvent("setting_changed."+e),o.$acceptBriefsCheckbox.toggleClass("sel"),n.setAcceptingBriefEducationSeen(),n.validateAcceptingBriefBudgetForm(),n.updateSellerSettings(),n.reportAcceptingBriefsToggleMetrics()}),o.$budgetInput.on("input",function(){n.validateAcceptingBriefBudgetForm()}),o.$btnToggleSetBriefBudget.on("click",function(e){e.preventDefault();var t=o.$toggleAcceptBriefs.offset(),i={left:t.left,top:t.top};n.setAcceptingBriefEducationSeen(),o.$setAcceptingBriefBudgetPopover.removeClass("hidden"),a.acceptingBriefBudget.acceptingBriefBudgetPopoverRef=o.$setAcceptingBriefBudgetPopover.bPopup({modal:!1,follow:[!1,!1],position:[i.left,i.top],onOpen:n.validateAcceptingBriefBudgetForm})}),o.$btnBriefBudgetPopoverClose.on("click",function(e){e.preventDefault(),a.acceptingBriefBudget.acceptingBriefBudgetPopoverRef.close()}),o.$btnBriefBudgetPopoverCancel.on("click",function(){o.$budgetInput.val(a.acceptingBriefBudget.minBudget),a.acceptingBriefBudget.acceptingBriefBudgetPopoverRef.close()}),o.$setAcceptingBriefBudgetForm.on("submit",function(e){e.preventDefault(),n.reportAcceptingBriefsBudgetChangeMetrics(),n.updateSellerSettings(function(){a.acceptingBriefBudget.acceptingBriefBudgetPopoverRef.close()})})},initAcceptingBriefsEducation:function(){o.$acceptingBriefEducation=$(".js-accepting-brief-budget-education"),o.$acceptingBriefEducationClose=o.$acceptingBriefEducation.find(".js-btn-got-it");const e=n.isEducationValueShown(a.acceptingBriefBudget.educationTooltipStorageKey),t=n.isGigTranslationEducationUrlParamExist();if(t)return!1;if(!e){o.$acceptingBriefEducation.removeClass("hidden");var i=o.$toggleAcceptBriefs.offset(),r={left:i.left,top:i.top};a.acceptingBriefBudget.acceptingBriefEducation=o.$acceptingBriefEducation.bPopup({modal:!1,follow:[!1,!1],position:[r.left,r.top]})}o.$acceptingBriefEducationClose.on("click",n.setAcceptingBriefEducationSeen)},isGigTranslationFeatureAvailable:function(){return o.$dropdownAnchorForTooltip=$('[data-translations-enabled="true"]').first(),!!o.$dropdownAnchorForTooltip.length},isGigTranslationEducationUrlParamExist:function(){const e=new Fiverr.URI(location.href).queryParams;return e.additional_languages_education},isGigTranslationTooltipAvailable:function(){const e=n.isGigTranslationEducationUrlParamExist();if(e)return!0;const t=n.isEducationValueShown(a.acceptingBriefBudget.educationTooltipStorageKey);return!t&&o.$toggleAcceptBriefs.length?!1:!n.isEducationValueShown(a.gigTranslations.educationTooltipStorageKey)},initGigTranslationsModel:function(){a.gigTranslations={educationTooltipStorageKey:"fiverr_education_tooltips.gig_translations_education"}},initGigTranslationsEducationStepTooltip:function(){if(o.$dropdownButton=o.$container.find(".fake-dropdown").first().find(".dropdown-toggle"),o.$gigTranslationsTooltip=$(".gig-translations-step-tooltip"),o.$gigTranslationsTooltip.length){const e=n.isGigTranslationTooltipAvailable();if(e){o.$dropdownButton.trigger("click"),o.$gigTranslationsTooltip.removeClass("hidden");const t=o.$dropdownAnchorForTooltip.offset(),i={left:t.left,top:t.top},r=function(){a.gigTranslations.stepTooltip.close()};o.$gigTranslationsTooltipButtonClose=o.$gigTranslationsTooltip.find(".js-btn-got-it"),o.$dropdowns=$(".filter-select"),o.$body=$("body"),a.gigTranslations.stepTooltip=o.$gigTranslationsTooltip.bPopup({modal:!1,follow:[!1,!1],position:[i.left,i.top],onOpen:function(){o.$body.on("click.education_namespace",r),o.$dropdowns.on("click.education_namespace",r),o.$gigTranslationsTooltipButtonClose.on("click.education_namespace",n.setGigTranslationsEducationSeen)},onClose:function(){o.$body.off("click.education_namespace",r),o.$dropdowns.off("click.education_namespace",r),o.$gigTranslationsTooltipButtonClose.off("click.education_namespace",n.setGigTranslationsEducationSeen)}})}}},initGigTranslationsEducation:function(){const e=n.isGigTranslationFeatureAvailable();e&&(n.initGigTranslationsModel(),n.initGigTranslationsEducationStepTooltip())},initTooltip:function(){var e=$(".js-w9-compliance");e.length&&e.find(".js-btn-close-tooltip").on("click",function(t){t.preventDefault(),e.addClass("hidden")})},setEducationValueAsSeen:function(e){const t=ft.utl.getLS(a.educationLocalStorageKey)||[];[e].forEach(function(e){return-1===t.indexOf(e)?t.push(e):void 0}),ft.utl.setLS(a.educationLocalStorageKey,t)},isEducationValueShown:function(e){const t=ft.utl.getLS(a.educationLocalStorageKey)||[];return _.isArray(t)?t.includes(e):!1},setAcceptingBriefEducationSeen:function(){n.setEducationValueAsSeen(a.acceptingBriefBudget.educationTooltipStorageKey),a.acceptingBriefBudget.acceptingBriefEducation&&a.acceptingBriefBudget.acceptingBriefEducation.close()},setGigTranslationsEducationSeen:function(){n.setEducationValueAsSeen(a.gigTranslations.educationTooltipStorageKey),a.gigTranslations.stepTooltip&&a.gigTranslations.stepTooltip.close(),o.$gigTranslationsTooltipButtonClose.off("click"),o.$dropdowns.off("click")},validateAcceptingBriefBudgetForm:function(){var e=o.$budgetInput.val(),t=o.$acceptBriefsCheckbox.prop("checked"),i=Number(e)>0&&t;n.toggleBriefBudgetPopoverSaveDisable(!i)},toggleBriefBudgetPopoverSaveDisable:function(e){o.$btnBriefBudgetPopoverSave.prop("disabled",e)},updateSellerSettings:function(e){var t=o.$acceptBriefsCheckbox.prop("checked"),i=o.$budgetInput.val(),a=100*i,r={disable:!t,minBudget:{amountInCents:a}};n.toggleBriefBudgetPopoverSaveDisable(!0),$.ajax({url:"/briefs/api/seller/settings",method:"PUT",data:JSON.stringify(r),contentType:"application/json",success:function(){n.updateBriefBudgetToggleText(i)},error:function(){n.displayFlashError(),n.reportSellerSettingsEvent("error"),Fiverr._logErrorToServer("manage_gigs.js","initToggles","[BRIEFS] Error in updating seller settings toggle (fail)")},complete:function(){n.validateAcceptingBriefBudgetForm(),e&&e()}})},reportAcceptingBriefsToggleMetrics:function(){this.reportAcceptingBriefsToggleMixpanelMetric(),this.reportAcceptingBriefsChangeBigQueryMetric()},reportAcceptingBriefsBudgetChangeMetrics:function(){this.reportAcceptingBriefsBudgetChangeMixpanelMetric(),this.reportAcceptingBriefsChangeBigQueryMetric()},reportAcceptingBriefsToggleMixpanelMetric:function(){var e=o.$acceptBriefsCheckbox.prop("checked"),t=e?"Opt in (on)":"Opt out (off)";this.reportAcceptingBriefsMixpanelMetric("Brief & Match seller config toggle",{"New state":t})},reportAcceptingBriefsBudgetChangeMixpanelMetric:function(){var e=o.$budgetInput.val();this.reportAcceptingBriefsMixpanelMetric("Brief & Match seller config min rate",{"New rate":e})},reportAcceptingBriefsChangeBigQueryMetric:function(){var e=o.$acceptBriefsCheckbox.prop("checked"),t=o.$budgetInput.val();this.reportAcceptingBriefsBigQueryMetric("seller_clicked_on_change_toggle_mode_of_get_briefs",{seller:{id:a.user.userId,brief:{is_accepting:e,minimum_price_rate:t}}})},reportAcceptingBriefsMixpanelMetric:function(e,t){const i=Object.assign({"Source Component":"Seller Configuration","Seller ID":a.user.userId},t);MixpanelWrapper.trackEvent(e,i)},reportAcceptingBriefsBigQueryMetric:function(e,t){var i=Object.assign({type:e,group:"buyer_request",entity:"client",feature:{name:"brief_and_match"},page:{ctx_id:a.ps.pageCtxId,element:{type:"button"}},action:{type:"click"},out_of_session:!1},t);Fiverr.sendClientEvents(i)},updateBriefBudgetToggleText:function(e){if(Number(e)>0){var t="$"+e,i=$.t("manage_gigs.index.briefs.from_budget",{budget:t});o.$btnToggleSetBriefBudget.text(i)}},reportSellerSettingsEvent:function(e){Fiverr._logEventToGraphite({label:"manage_gigs.seller_settings.briefs."+e,percentage:100})},displayFlashError:function(){Fiverr._showFlashMessage({content:$.t("general.something_went_wrong"),type:"error",disableScroll:!0,showCloseButton:!0})},bindChartEvents:function(){var e,i,a={};e=function(e){return e.dataContext.balloonData?'<div class="graph-tooltip">'+e.dataContext.balloonData+"</div>":""},i=function(t,i){var n="js-graph-"+t,o=$("#"+n),r=o.parent().find(".js-graph-desc"),s="",c="",l={type:"serial",pathToImages:"/",categoryField:"date",dataDateFormat:"YYYYMMDD",maxSelectedSeries:0,minSelectedTime:5,depth3D:0,zoomOutButtonImage:"",zoomOutText:"",borderColor:"#eeeeee",color:"#7b7b7b",fontFamily:"Helvetica Neue",hideBalloonTime:151,fontSize:11,panEventsEnabled:!1,categoryAxis:{boldPeriodBeginning:!1,centerLabelOnFullPeriod:!1,firstDayOfWeek:1,markPeriodChange:!1,parseDates:!0,startOnAxis:!0,titleBold:!1,axisColor:"#eeeeee",gridColor:"#eeeeee",gridAlpha:1},chartCursor:{bulletsEnabled:!0,categoryBalloonEnabled:!1,zoomable:!1,cursorAlpha:0},trendLines:[],graphs:[{bullet:"round",bulletSize:8,bulletBorderAlpha:1,bulletBorderColor:"#FA6E23",bulletColor:"#f9f9f9",colorField:"bulletColor",id:"value",lineThickness:3,switchable:!1,title:"value",topRadius:0,valueField:"value",visibleInLegend:!1,balloonFunction:e}],balloonText:"[[balloonData]]",guides:[],valueAxes:[{id:"value",axisColor:"#eeeeee",gridColor:"#eeeeee",gridAlpha:1}],allLabels:[],balloon:{borderAlpha:0,borderThickness:0,color:"#FFFFFF",cornerRadius:3,fadeOutDuration:.34,fillAlpha:1,fillColor:"#555555",fontSize:12,horizontalPadding:9,shadowAlpha:0,textAlign:"left"},titles:[],dataProvider:""};o.length&&(i?(s=$.parseJSON(i.graph_data),c=i.graph_description):(s=o.data("graph-data"),c=o.data("graph-desc")),s.length?(l.dataProvider=s,a[t]=AmCharts.makeChart(n,l),a[t].validateData()):$("#"+n).html('<span class="no-data">'+$.t("manage_gigs.index.no_graph_data")+"</span>"),r.html(c))},_.delay(function(){o.$container.on("click",".js-toggle-gig-stats a",function(e){e.preventDefault();var a=$(this),r=a.closest("tr"),s=r,c=a.attr("href"),l=c,g=ft.utl.getUrlVars().days_for_stats?ft.utl.getUrlVars().days_for_stats:30,d={initial:{text:$.t("manage_gigs.index.graph_filters.impressions")},doPreventDefault:!0,options:[{text:$.t("manage_gigs.index.graph_filters.impressions"),val:"impressions_daily",attrs:'class="selected"'},{text:$.t("manage_gigs.index.graph_filters.clicks"),val:"clicks_daily"},{text:$.t("manage_gigs.index.graph_filters.orders"),val:"sale"},{text:$.t("manage_gigs.index.graph_filters.conversion"),val:"conversion_rate"}],onAction:function(e,n){var a=$(e),o=$(n),r=a.closest(".filter-select"),s=r.data("gig-graph-data-path"),c=r.data("gig-id"),l=a.data("val");o.text(a.text()),$.ajax({type:"get",url:s,dataType:"json",data:{graph_type:l,days_for_stats:g},success:function(e){i(c,e)}}),MixpanelWrapper.trackEvent(t.GIG_PERFORMANCE_EVENT_TYPE_SELECT,{"New Type":l})}};l=l.replace(new RegExp("/edit$"),"/extra_info"),s.hasClass("show-statistics")?s.next().hasClass("mygigs-statistics")&&s.next().find(".gig-stats").toggle():(s.addClass("show-statistics"),s.after('<tr class="mygigs-statistics loader"><td colspan="10" class="gig-stats"><div class="loading"></div></td></tr>'),$.ajax({type:"get",dataType:"text",url:l,data:{graph_type:"impressions_daily",days_for_stats:g}}).done(function(e){var e=$.parseJSON(e);Fiverr._getHbTemplate({tplType:"dashboard-new",tplName:"manage-gigs-graph",tplData:e},function(a){var r=$(a);s.after(r),n.initLanguagesStatusesBlock(s),d.attrs='data-gig-graph-data-path="'+e.extra_info.gig_graph_data_url+'" data-gig-id='+e.extra_info.gig_id,r.find(".js-ddown-graph-type").fakeDropdown(d),i(e.extra_info.gig_id),$(".mygigs-statistics.loader").hide(),Fiverr.pushGoogleUniversalTag("My Gigs","Open Gig","Gig Dashboard"),o.$toggleWatermark=r.find(".js-btn-toggle-watermark"),o.$toggleWatermark.length&&n.bindWatermarkToggle(),"undefined"!=typeof fOverbookedMode&&fOverbookedMode(e.extra_info.gig_id),r.find("label input[type=checkbox]").change(function(e){var i=$(e.target).closest("label")[0]&&$(e.target).closest("label")[0].textContent.trim(),n=e.target.checked?"on":"off";MixpanelWrapper.trackEvent(t.GIG_TOGGLE,{"Toggle Name":i,"New State":n})})})}),MixpanelWrapper.trackEvent(t.GIG_CLICK))})},200)},initLanguagesStatusesBlock:function(e){var t=e.data("slug"),i=e.data("enabled"),o=e.data("id");if(i){var r=e.next().find(".js-add-languages"),s=e.next().find(".js-edit-languages"),c={type:"gig_translation.add_languages_clicked",group:"user_actions",entity:"client",visit_id:window.Houston&&window.Houston.pageId||null,uid:a.ps.mixpanelAttributes.super_properties["User Guid"],page:{ctx_id:a.ps.pageCtxId},user:{id:a.user.userId},seller:{id:a.user.userId},gig:{id:o,source_language_code:"en"},action:{type:"click"},localization:{display_currency:a.ps.currency.name,experience_locale:a.ps.locale,formatting_locale:window.initialData.LocalizationContext.formattingLocale}};r.find(".js-add-languages-link").on("click",function(){Fiverr.sendClientEvents(c)}),s.find(".js-edit-languages-link").on("click",function(){Fiverr.sendClientEvents(c)}),$.ajax({type:"get",dataType:"json",url:"/manage_gigs/"+t+"/translation_layers/statuses"}).done(function(e){const t=["de","fr"];if(e){const i=e,a=Object.keys(i).filter(function(e){return t.includes(e)});if(a.length){const o=a.map(function(e){return n.createLanguageStatusItem(i,e)});s.find(".js-languages-statuses").append(o),r.hide(),s.show()}}})}},createLanguageStatusItem:function(e,t){var i=e[t],n="active"===i?"active":"",a=i18n.t("language_names."+t);return'<div class="m-t-16 status-data"><div class="name">'+a+'</div><div class="status '+n+'">'+i+"</div></div>"},bindWatermarkToggle:function(){o.$chkWatermark=o.$toggleWatermark.find('input[type="checkbox"]'),o.$chkWatermark.change(function(e){var t,i=$(this).closest("tr").data("slug");$(this).toggleClass("sel"),t=$(this).hasClass("sel"),$.ajax({url:"/users/"+a.user.userName+"/manage_gigs/"+i+"/toggle_watermark",data:{active:t,source:a.ps.main+"."+a.ps.sub},method:"POST",error:function(){alert($.t("general.something_went_wrong")),o.$chkWatermark.toggleClass("sel")}})})},bindBulkActions:function(){var e,t=o.$container.find("tr[data-id]"),r=t.find(".js-cbx-gig-row");e=function(){o.bulkActions.$btnMyGigsAction.addClass("disabled hidden");var e=[];switch(a.page.currentFilter){case"active":case"pending":e.push("delete");break;case"requires_mod":case"denied":case"draft":e.push("delete");break;case"suspend":e.push("activate"),e.push("delete")}if(r.is(":checked")){var t=document.pageScope.currentUser&&!!document.pageScope.currentUser.displayname,i=r.filter(":checked"),s=_.map(i,function(e){return e.value}).map(function(e){return n.getGigById(Number(e))}).some(function(e){return e.studio});$.each(e,function(e,i){var n=o.bulkActions.$btnMyGigsAction.filter('[data-action="'+i+'"]');!s&&t||"activate"!==i?n.removeClass("disabled hidden"):n.removeClass("hidden")}),o.bulkActions.$container.removeClass("hidden")}else o.bulkActions.$selectAllGigs.prop("checked",!1),o.bulkActions.$container.addClass("hidden")},o.bulkActions.$selectAllGigs.off("change").on("change",function(){var t=$(this).is(":checked");r.prop("checked",t),e()}),r.off("change").on("change",function(){e()}),o.bulkActions.$btnMyGigsAction.off("click").on("click",function(e){e.preventDefault();var t,n=$(this),s=n.data("action"),c=r.filter(":checked"),l=_.map(c,function(e){return e.value}),g=c.closest("tr");if(!n.hasClass("disabled")){switch(Fiverr.pushGoogleUniversalTag("My Gigs","Top Action",s),s){case"delete":if(!confirm($.t("manage_gigs.edit.confirm_delete_selected_plural")))return void e.preventDefault();t="deleted";break;case"activate":t="active";break;case"suspend":t="suspend"}g.fadeOut(),i.shared.statusTabs.raiseCount(-c.length),i.shared.statusTabs.raiseCount(c.length,t),$.ajax({type:"post",url:a.baseRoute+"/"+s,dataType:"text",data:{id:l||[],source:a.ps.main+"."+a.ps.sub},success:function(){g.remove(),o.bulkActions.$selectAllGigs.prop("checked",!1),r.length-c.length===0&&(a.page.results.rows=[{type:"none",cells:[{text:$.t("manage_gigs.index.no_results.no_gigs_in_filter"),type:"empty",colspan:10}]}],o.$container.find(o.$mainTable.find("tbody")).html(""),i.shared.addTableRows(a.page.results.rows,o.$mainTable.find("tbody")))},error:function(){window.location.reload()}})}}),e()},getGigById:function(e){if(!e||!$.isNumeric(e)||!a.page.results.rows)return null;var t=$.grep(a.page.results.rows,function(t){return t.gig.id===e});return t&&t.length&&t[0].gig},bindEvents:function(){n.bindChartEvents(),n.bindDropdowns(),n.bindBulkActions(),n.bindPlanLinks(),$(window).on("afterAddTableRows",function(){n.bindBulkActions()}),o.$container.on("submit",".js-delete-gig-form",function(e){return confirm($.t("manage_gigs.form.placeholders.confirm_gig_delete"))?void 0:(e.preventDefault(),!1)}),o.$container.on("click",".js-edit-portfolio",function(e){e.preventDefault(),e.stopImmediatePropagation();var t=$(this),i=t.find(":checkbox");_.delay(function(){i.prop("checked",!i.prop("checked")),$.ajax({type:"post",dataType:"text",url:t.attr("href"),data:{source:a.ps.main+"."+a.ps.sub}})},50)}),o.$container.on("click",".js-btn-gig-share-dropdown",function(e){e.preventDefault();var t=$(this).closest("tr").data("id"),i=n.getGigById(t);if(i){var a,o={detail:{source:"gigs_show",resource_type:"gig",resource_id:i.id,is_resource_owner:!0,interpolation_variables:{gig_title:i.title}}};"function"==typeof window.CustomEvent?a=new CustomEvent("open-share-modal",o):(a=document.createEvent("CustomEvent"),a.initCustomEvent("open-share-modal",!1,!1,o.detail)),window.dispatchEvent(a)}}),o.$container.on("mouseenter",".js-revenues-tt",function(e){var t=$(this);$.ajax({type:"get",dataType:"json",url:"/users/"+Fiverr.models.user.userName+"/manage_gigs/"+t.data("gig")+"/revenues",success:function(e){t.attr("data-hint",$.t("manage_gigs.form.tooltips.revenues_tooltip")+e.total),t.off("mouseenter")}})}),o.$btnStatusesPopup.on("click",function(e){e.preventDefault(),Fiverr._getHbTemplate({tplType:"popups",tplName:"popup-statuses",tplData:a.page.popups.statuses,dependencies:["//assetsv2.fiverrcdn.com/assets/desktop/popups/popup-statuses-c098e3449c55ef592553987bb27bff4e.css","//assetsv2.fiverrcdn.com/assets/dist/templates-compiled/popups/popup-statuses-ff591541ea0320bb5c841a5082abec7a.js"],callback:function(e){var t=$(e);$(document.body).append(t),t.bPopup({closeClass:"js-btn-close",opacity:.6})}})})},bindDropdowns:function(){var e;e=function(e,t){var i=$(e),n=i.text(),o=i.data("val");t.html(n),a.page.dds.timeRange.current.val=o,updateResults()},updateResults=function(){var e=o.$mainTable.find("tbody"),t={current_filter:a.page.currentFilter,days_for_stats:a.page.dds.timeRange.current.val};$.ajax({url:a.baseRoute,type:"get",dataType:"json",data:t,cache:!1}).done(function(n){i.shared.replaceLocation(t),a.page.results.rows=n.results.rows,a.page.results.rows&&(o.$container.find(e).html(""),i.shared.addTableRows(a.page.results.rows,e))})},o.dds.$timeRange.fakeDropdown({initial:{text:a.page.dds.timeRange.current.text,val:a.page.dds.timeRange.current.val},options:a.page.dds.timeRange.options,doPreventDefault:!0,onAction:e,autowidth:!0})},bindPlanLinks:function(){o.$container.on("click",".js-add-plan",function(e){$(e.target).hasClass("subscription")&&MixpanelWrapper.trackEvent("Manage gigs - Add subscription clicked"),$(e.target).hasClass("work-process")&&MixpanelWrapper.trackEvent("Manage gigs - Add milestone clicked")})},attachEvents:function(){var e=function(e,i){MixpanelWrapper.trackEvent(t.GIG_MENU_ITEM_CLICK,{"Item Name":i})};$(".js-db-table tbody .dropdown-toggle").click(function(e){MixpanelWrapper.trackEvent(t.GIG_MENU_CLICK)}),$(".js-db-table tbody .filter-select .dropdown-menu a, .js-db-table tbody .filter-select .dropdown-menu label").click(function(t){e(t,t.target.textContent&&t.target.textContent.trim())}),$('.js-db-table tbody .filter-select .dropdown-menu input[type="submit"]').click(function(t){e(t,t.target.value)})}};var i=fDashboardNew,n=fDashboardNew.manageGigs,a=n.models,o=n.selectors}();